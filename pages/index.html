<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Aniversário da Ivy · Convite</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=Pacifico&family=Lora&display=swap" rel="stylesheet" />

  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

  <meta name="theme-color" content="#0ea5e9" />
  <link rel="stylesheet" href="../styles/utilities.css" />
  <link rel="stylesheet" href="../styles/components/card.css" />
  <link rel="stylesheet" href="../styles/components/buttons.css" />
  <link rel="stylesheet" href="../styles/components/hero.css" />
  <link rel="stylesheet" href="../styles/components/dateTime.css" />
</head>
<body class="min-h-screen flex items-center justify-center p-[5%] font-body text-gray-800 selection:bg-[var(--sea-200)]/70">
  
  <!-- O novo componente de fundo animado é carregado aqui. -->
  <!-- A classe de gradiente de fundo do body foi removida para que ele seja visível. -->
  <div id="MoanaBackground" data-component-path="../components/MoanaBackground.html"></div>

  <div class="card-wrapper max-w-sm w-full rounded-[2rem] bg-white shadow-2xl overflow-hidden relative ring-2 ring-white/60">

    <div class="card-bg absolute inset-0 -z-10 bg-cover bg-center" style="background-image: url('../assets/images/beachBG.jpg'); filter: blur(5px);"></div>

    <div id="InviteHero" data-component-path="../components/InviteHero.html"></div>
    <script src="../hooks/useComponentLoader.js"></script>

    <section class="px-[7%] bg-[#ffffff2d]">
      <p class="text-center text-extrabold">
        O oceano está chamando!<br>
        Venha comemorar comigo meu aniversário!
      </p>
    </section>

<section class="px-[7%] mt-[6%]">
      <div class="datetime-wrapper">
        <div class="datetime-block">
          <p class="datetime-number">14</p>
          <p class="datetime-label">Setembro</p>
        </div>

        <div aria-hidden="true" class="datetime-star">
          <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"
               class="drop-shadow-md">
            <path
              d="M31.6 6c1.2 0 2.3 5.2 4.4 8.6 2.1 3.4 6.1 5 8.8 6.4 2.7 1.4 3.9 2.6 3.4 3.9-.5 1.3-2.6 1.5-6 2.2-3.4.7-8.1 1.8-9.8 4.2-1.7 2.4-.7 6.1-.3 9.6.4 3.5.4 6.8-1 7.1-1.4.3-3.9-2.6-6.3-4.8-2.4-2.2-4.7-3.7-7.6-3.4-2.9.3-6.4 2.2-9.4 3-3 .8-5.4.6-5.9-.8-.5-1.4 1.2-3.8 2.7-6.5 1.5-2.7 2.9-5.6 2.6-8.1-.3-2.5-2.1-4.6-3.7-7.4C1.9 17 1 14.1 2.2 13.2c1.2-.9 4 .3 7.4 1.3 3.4 1 7.5 1.7 10.2.7 2.7-1 4.1-3.6 6.4-6.7S30.4 6 31.6 6Z"
              fill="url(#g)" />
            <defs>
              <linearGradient id="g" x1="0" y1="6" x2="64" y2="58" gradientUnits="userSpaceOnUse">
                <stop stop-color="#F472B6" />
                <stop offset="1" stop-color="#EC4899" />
              </linearGradient>
            </defs>
          </svg>
        </div>

        <div class="datetime-block">
          <p class="datetime-number">12</p>
          <p class="datetime-label">Horas</p>
        </div>
      </div>
    </section>

    
    <section class="px-[8%] ml-[10%] mt-[8%] mb-[15%]">
        <section id="header-section" class="items-center justify-center ml-[15%]" aria-label="Cabeçalho convite">
            <p id="subtitle">Você vem?</p>
        </section>
    <div class="flex items-center justify-center gap-8">
      <div class="w-1/2 text-center">
        <button type="button" onclick="abrirLocalizacao()" aria-label="Abrir localização" class="btn-circle">
          <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="#f9c3d2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 2C8 5 8 10 12 22C16 10 16 5 12 2Z"></path>
            <circle cx="12" cy="10" r="3"></circle>
          </svg>
        </button>
        <p class="btn-label">Abrir<br>Localização</p>
      </div>

      <div class="w-1/2 text-center">
        <button type="button" onclick="mostrarFormulario()" aria-controls="formularioRSVP" aria-expanded="false" class="btn-circle">
          <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="#f9c3d2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <path d="M16 16l2 2 4-4"></path>
          </svg>
        </button>
        <p class="btn-label">Confirmar<br>Presença</p>
      </div>
    </div>
</section>

    <section id="formularioRSVP" class="hidden px-[8%] mb-[15%] pb-[8%]">
      <form id="rsvpForm" class="grid gap-[4.5%]" novalidate>
        <label class="grid gap-[2%]">
          <span class="text-sm text-gray-800">Seu nome</span>
          <input name="nome" required
                  class="rounded-xl border border-gray-300 px-[4%] py-[3%] focus:outline-none focus:ring-2 focus:ring-teal-400" />
        </label>
        <label class="grid gap-[2%]">
          <span class="text-sm text-gray-800">Quantas pessoas no total?</span>
          <input name="convidados" type="number" min="1" value="1"
                  class="rounded-xl border border-gray-300 px-[4%] py-[3%] focus:outline-none focus:ring-2 focus:ring-teal-400" />
        </label>
        <button type="submit"
                 class="rounded-2xl px-[5%] py-[3.5%] bg-rose-500 text-white font-semibold shadow-md active:scale-95">
          Enviar confirmação
        </button>
        <p id="statusRSVP" class="text-2xl text-gray-800"></p>
      </form>
    </section>

    <section class="relative mt-[-15%] pt-[3%] pb-[6%] flex justify-center gap-[2%] items-end">
      <img src="../assets/images/moana-baby.png" alt="Moana bebê" loading="lazy"
             class="w-[58%] -scale-x-100" onerror="this.style.display='none'"/>
      <img src="../assets/images/pua.png" alt="Pua" loading="lazy"
             class="w-[22%]" onerror="this.style.display='none'"/>
      <img src="../assets/images/heihei.png" alt="Heihei" loading="lazy"
             class="w-[18%]" onerror="this.style.display='none'"/>
    </section>

  </div>

  <script>
    function abrirLocalizacao() {
      const locationURL = 'https://www.google.com/maps/search/?api=1&query=-22.761338,-46.307044';
      window.open(locationURL, '_blank');
    }
    function mostrarFormulario() {
      const el = document.getElementById('formularioRSVP');
      el.classList.toggle('hidden');
    }

    const form = document.getElementById('rsvpForm');
    const status = document.getElementById('statusRSVP');
    if (form) {
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        status.textContent = 'Enviando...';
        const payload = Object.fromEntries(new FormData(form).entries());
        console.log('Nome:', payload.nome); 
        console.log('Convidados:', payload.convidados);

        try {
          const res = await fetch('/api/rsvp', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });
          if (!res.ok) throw new Error();
          status.textContent = 'Confirmação recebida! Obrigado.';
          form.reset();
        } catch {
          status.textContent = 'Erro ao enviar. Tente novamente.';
        }
      });
    }
  </script>
</body>
</html>
